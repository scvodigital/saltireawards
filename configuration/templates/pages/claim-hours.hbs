<div class="container b-padding-full v-margin-full">
  <h1>
    Claim hours by certificate code
  </h1>
  <form id="input-code-form" action="/submit-hours-claim" method="POST" data-ajax-form='{
    "successCallback": "completeHoursClaim",
    "failureCallback": "completeHoursClaim"
  }'>
    <div class="columns col-gapless">
      <div class="col-6">
        <div class="form-group">
          <label for="hours_claim_code" class="form-label">
            Enter your claim code
          </label>
          <input id="task-code" name="hours_claim_code" class="form-input" {{>form_validation_attributes @root.context.metaData.taskInfoValidation.task-code}}>
        </div>
      </div>
      <div class="col-6">
        <button id="detail-submit" type="submit" class="submit-button btn btn-primary b-margin-full">
          Claim hours
        </button>
      </div>
    </div>
  </form>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    $('#input-code-form').on('submit', function(e){
      $('#input-code-form').find('.submit-button').prop('disabled', true);
    })

  });
  function completeHoursClaim(response){
    var jsonData = JSON.parse(response);
    if (jsonData.id){
      window.location.href = '/hours/';
    } else {
      $('.submit-button').prop('disabled', false);
      saltireawards.componentsInitialiser.snackbar.show({message:"Failed to claim hours."});
    }
  }
</script>