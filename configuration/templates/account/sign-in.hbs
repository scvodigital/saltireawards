<form id="sign-in-form" method="POST" class="authentication-form container">
  <h1 class="x-padding">
    {{#if @root.request.params.query.reauth}}
      Please sign in again
    {{else}}
      Welcome back! Please sign in
    {{/if}}
  </h1>
  {{#if @root.request.params.query.reauth}}
  <p class="x-padding">
    Before you can do that you must sign in again
  </p>
  {{/if}}
  <div class="l-margin r-margin">
    <div class="x-padding-full" id="sign-in-message">
      <span id="form-message"></span>
    </div>
  </div>
  <div class="x-padding">
    <div id="form-section-email">
      {{> account_sign_in_social messageSelector="#sign-in-message"}}

      <div class="divider text-center v-margin-full" data-content="or"></div>

      <div class="form-group has-icon-left">
        <input class="form-input" type="email" id="sign-in-email" placeholder="Email" />
        <span class="form-icon far fa-at" id="sign-in-email-icon"></span>
      </div>

      <div class="form-group has-icon-left">
        <input class="form-input" type="password" id="sign-in-password" placeholder="Password" />
        <span class="form-icon far fa-key" id="sign-in-password-icon"></span>
      </div>
    </div>
    <div id="form-section-sign-in-buttons" class="t-margin">
      <button class="btn btn-primary" type="submit" id="sign-in-submit">
        Sign in
      </button>
      <p class="v-margin-full">
        Forgot your password? <a href="/reset-password">Reset password</a>
      </p>
      <p class="v-margin-full">
        Read our <a href="/privacy" target="_blank">privacy notice</a>
      </p>
      <h2>
        Not registered?
      </h2>
      <div class="v-margin-full">
        <a href="/sign-up" class="btn btn-primary">Sign up for a free account</a>
      </div>
    </div>
  </div>
</form>
<script>
document.addEventListener("DOMContentLoaded", function(event) {
  var $form = $('#sign-in-form');
  var $message = $('#sign-in-message');
  var $email = $('#sign-in-email');
  var $password = $('#sign-in-password');
  var $emailIcon = $('#sign-in-email-icon');
  var $passwordIcon = $('#sign-in-password-icon');
  var $login = $('#sign-in-submit');

  $form.on('submit', function(evt) {
    $emailIcon.addClass('loading');
    $passwordIcon.addClass('loading');
    var email = $email.val();
    var password = $password.val();
    evt.preventDefault();
    saltireawards.auth.signInEmailPassword(email, password).then(function(user) {
      window.location.href = '/';
    }).catch(function(err) {
      $message.html(err.message+' <a href="/reset-password">Reset password</a>').show();
      $emailIcon.removeClass('loading');
      $passwordIcon.removeClass('loading');
    });
  })
});
</script>